---
title: Dubbo Knowledge points
date: 2023-07-22 15:27
categories:
- Dubbo
tags:
- Dubbo
---

## 背景
Dubbo知识点整理

## Dubbo 知识点

Dubbo是一款高性能的分布式服务框架，由阿里巴巴开源，用于解决分布式系统中的服务治理问题。下面是Dubbo的一些重要知识点：

### 1. Dubbo 简介

Dubbo是一款开源的高性能、轻量级的分布式服务框架，它提供了服务注册、发现、远程调用、负载均衡等分布式服务治理功能，使得分布式系统开发更加简单和高效。

### 2. Dubbo 核心概念

- 服务提供者(Provider)：暴露服务的服务提供方。
- 服务消费者(Consumer)：调用远程服务的服务消费方。
- 注册中心(Registry)：用于服务的注册与发现，Dubbo支持多种注册中心，如ZooKeeper、Consul等。
- 监控中心(Monitor)：用于统计服务的调用次数和调用时间等。
- 服务容器(Container)：服务运行容器，负责启动、加载、运行服务提供者。

### 3. Dubbo 服务暴露与引用

- 服务暴露：通过`@Service`注解将服务接口实现类暴露为Dubbo服务，并配置服务的协议、注册中心等信息。
- 服务引用：通过`@Reference`注解或配置XML来引用远程服务，获取对服务接口的代理对象，从而进行远程调用。

### 4. Dubbo 配置

Dubbo提供了丰富的配置选项，可以通过XML配置文件或注解进行配置，包括服务提供者和服务消费者的配置，以及注册中心、协议、负载均衡等配置。

### 5. Dubbo 负载均衡

Dubbo支持多种负载均衡策略，用于决定服务消费者选择哪个服务提供者进行远程调用。常见的负载均衡策略有：随机(Random)、轮询(RoundRobin)、最少活跃调用数(LeastActive)等。

### 6. Dubbo 集群容错

Dubbo提供了集群容错机制，用于处理服务调用时可能出现的失败情况，如服务提供者不可用、调用超时等。常见的集群容错策略有：失败自动切换(Failover)、失败快速失败(Failfast)、失败安全(Failsafe)等。
```
失败自动切换（Failover）：
失败自动切换是 Dubbo 默认的集群容错策略。当服务消费者在调用过程中遇到失败，比如请求超时或服务提供者抛出异常时，Dubbo 会自动切换到另一个可用的服务提供者进行重试。Dubbo 默认设置了重试次数为 2 次，可以通过配置进行调整。

失败快速失败（Failfast）：
失败快速失败策略是指在服务调用失败后立即返回失败的响应，不进行重试。这种策略适用于非幂等操作，比如写操作，因为重试可能会导致数据重复提交。

失败安全（Failsafe）：
失败安全策略是指在服务调用失败时，直接忽略失败的调用，不进行重试，将失败视为一个普通的警告，继续执行后续逻辑。这种策略适用于日志记录等不影响主要业务的情况。

失败自动恢复（Failback）：
失败自动恢复策略是指在服务调用失败后，后台记录失败的请求，并定时重发这些失败的请求，直到成功。这种策略适用于可靠性要求较高的场景，比如消息通知。

失败失败重试一次（Failover + Failfast）：
这种策略结合了失败自动切换和失败快速失败两种策略。在首次调用失败时会立即返回失败响应，但会进行一次重试，尝试调用另一个可用的服务提供者。

这些集群容错策略使得 Dubbo 在面对不同的分布式调用异常情况时，能够根据实际场景进行合理的处理，提高了系统的可用性和稳定性。在使用 Dubbo 时，可以根据业务需求和系统特点选择合适的集群容错策略，并通过 Dubbo 的配置进行相应的调整。
```

### 7. Dubbo 过滤器

Dubbo提供了过滤器机制，可以在服务提供者和服务消费者之间进行过滤器链的调用，用于实现日志记录、安全认证、参数验证等功能。
```
Dubbo 过滤器分为两类：

服务端过滤器（Provider Filter）：
服务端过滤器在服务提供者端执行，用于在服务被调用之前和之后对请求进行处理。服务端过滤器的执行顺序与它们在 Dubbo 配置文件中的顺序有关，先声明的过滤器先执行。

客户端过滤器（Consumer Filter）：
客户端过滤器在服务消费者端执行，用于在服务调用之前和之后对请求进行处理。客户端过滤器的执行顺序同样与它们在 Dubbo 配置文件中的顺序有关，先声明的过滤器先执行。

Dubbo 提供了一些内置的过滤器，例如：

AccessLogFilter：记录请求访问日志，可以查看请求的详细信息，如调用方IP、接口、方法、参数等。
ActiveLimitFilter：限制并发调用数，防止过多的并发请求对服务提供者造成压力。
EchoFilter：回声测试过滤器，用于检测服务是否正常。
ExceptionFilter：捕获服务调用过程中的异常，可用于异常处理和记录。
开发者还可以根据自己的需求实现自定义的过滤器，并通过 Dubbo 配置文件将其加入过滤器链中。自定义过滤器需要实现 Filter 接口，并重写其 invoke(Invoker, Invocation) 方法，这样在服务调用的时候就会触发自定义过滤器的执行。
```

### 8. Dubbo 异步调用

Dubbo支持异步调用方式，可以在服务消费者发起调用后继续执行其他逻辑，待服务提供者处理完毕后再获取结果。

### 9. Dubbo SPI

Dubbo使用SPI（Service Provider Interface）机制来加载扩展点实现，可以通过SPI扩展机制自定义一些组件的实现。

```
自定义集群容错策略：
可以根据实际业务场景和需求，实现自定义的集群容错策略。例如，你可能需要一个特定的容错策略来处理某些业务场景下的失败情况，或者根据自己的需求来定制重试次数和重试间隔等参数。

自定义负载均衡策略：
Dubbo 默认提供了一些常见的负载均衡策略，但在特定的业务场景下，可能需要更加个性化的负载均衡策略。通过自定义负载均衡策略，你可以根据实际需求来选择合适的服务提供者进行调用。

自定义注册中心：
如果 Dubbo 默认提供的注册中心不符合你的需求，你可以实现自定义的注册中心来适配你的特定场景。比如，你可能希望将 Dubbo 与自己的服务发现系统集成，就可以实现一个自定义的注册中心。

自定义远程通信协议：
Dubbo 支持多种远程通信协议，但在特定情况下，你可能需要一个全新的远程通信协议来满足特定的需求。通过自定义远程通信协议，你可以实现自己的通信协议实现，与 Dubbo 集成。

自定义序列化方式：
如果 Dubbo 默认提供的序列化方式不满足你的需求，你可以实现自定义的序列化方式。比如，你可能希望使用一种特定的序列化算法来优化性能，或者与其他系统进行数据交换，就可以实现一个自定义的序列化方式。

自定义拓展点加载器：
Dubbo 的拓展点加载器是用于加载各种扩展点实现的机制，如果你希望扩展 Dubbo 的功能，可以通过自定义拓展点加载器来加载自定义的扩展点实现。
```

### 10. Dubbo 序列化
```
Dubbo的序列化是指在服务提供者和服务消费者之间传输数据时，将Java对象转换成字节流，或将字节流还原成Java对象的过程。在分布式系统中，服务的提供者和消费者通常运行在不同的进程或服务器上，需要通过网络进行数据传输。Dubbo默认使用Hessian2作为序列化方式，但也支持其他的序列化方式，如JSON和FST。

Hessian2序列化：
Hessian2是一种高效的二进制序列化协议，它将Java对象转换为紧凑的二进制格式，使得数据传输更加高效。Hessian2序列化具有较低的序列化和反序列化开销，适合在分布式系统中传输大量的数据。Dubbo默认使用Hessian2作为序列化方式，可以通过在Dubbo配置中指定hessian2来启用。

JSON序列化：
JSON是一种常用的文本格式数据交换协议，相对于Hessian2而言，JSON序列化产生的数据较大，传输效率相对较低，但可读性较好，适用于一些对数据可读性要求较高的场景。在Dubbo中，你可以选择使用json作为序列化方式，通过配置来实现。

FST序列化：
FST（Fast-Serialization）是一种高性能的Java对象序列化框架，它通过直接操作字节码，绕过了Java的标准序列化机制，从而达到了更高的序列化和反序列化性能。FST序列化在性能方面优于Hessian2和JSON，但可能不如Hessian2那么通用。Dubbo支持FST作为序列化方式，可以通过配置来启用。

选择合适的序列化方式取决于具体的业务需求和场景。对于数据量较大且传输性能要求较高的场景，Hessian2是一个不错的选择；如果对数据可读性要求较高，JSON可以作为一个备选；而对于追求更高性能的场景，FST可能是更好的选择。在Dubbo中，你可以根据业务需求和系统性能来灵活选择合适的序列化方式。
```

以上是Dubbo的一些核心知识点，当准备面试Java时，对于Dubbo的了解将对面试中的分布式系统和服务治理相关问题有很大帮助。希望这些知识点对您的面试有所帮助。祝您面试成功！


